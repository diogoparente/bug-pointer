import prisma from "@/database/client";
import { SubmittedVulnerability } from "@prisma/client";

const getAllSubmittedVulnerabilies = async () => {
  const allSubmittedVulnerabilies = await prisma.submittedVulnerability.findMany();
  return allSubmittedVulnerabilies;
};

const insertSubmittedVulnerability = async (submittedVulnerability: WithoutId<SubmittedVulnerability>) => {
  let insertedSubmittedVulnerability;
  try {
    insertedSubmittedVulnerability = await prisma.submittedVulnerability.create({
      data: submittedVulnerability,
    });
  } catch (error) {
    console.log(error);
  }

  return insertedSubmittedVulnerability;
};

const getSubmittedVulnerabilitiesByContestAddress = async (contestAddress: string) => {
  const submittedVulnerabilities = await prisma.submittedVulnerability.findMany({
    where: {
      contestAddress,
    },
  });
  return submittedVulnerabilities;
};

export { getAllSubmittedVulnerabilies, insertSubmittedVulnerability, getSubmittedVulnerabilitiesByContestAddress };
