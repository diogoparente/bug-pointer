import Tag from "../tag";
import { SubHeader, Paragraph } from "../text";

type SubmittedVulnerabilityInfoProps = {
  vulnerability: SubmittedVulnerability;
  status: "Reviewed" | "Discarded" | "Pending";
};

enum StatusColor {
  Reviewed = "green",
  Discarded = "red",
  Pending = "grey",
}

const SubmittedVulnerabilityInfo = ({ vulnerability, status }: SubmittedVulnerabilityInfoProps) => (
  <div className="flex w-full flex-col items-start justify-start gap-4">
    <div className="flex w-full flex-row items-center justify-between">
      <SubHeader className="text-left">{vulnerability.name}</SubHeader>
      <Tag color={StatusColor[status]}>{status}</Tag>
    </div>
    <Paragraph>{vulnerability.proofOfConcept}</Paragraph>
  </div>
);

type FilteredVulnerabilityInfoProps = {
  vulnerability: FilteredVulnerability;
};

enum SeverityColor {
  Critical = "red",
  High = "orange",
  Medium = "yellow",
  Low = "grey",
}

const FilteredVulnerabilityInfo = ({ vulnerability }: FilteredVulnerabilityInfoProps) => (
  <div className="flex w-full flex-col items-start justify-start gap-2">
    <div className="flex w-full flex-row items-center justify-between">
      <SubHeader className="text-left">{vulnerability.name}</SubHeader>
      <Tag color={SeverityColor[vulnerability.severity]}>{vulnerability.severity}</Tag>
    </div>
    <Paragraph>{vulnerability.proofOfConcept}</Paragraph>
  </div>
);

export { SubmittedVulnerabilityInfo, FilteredVulnerabilityInfo };
